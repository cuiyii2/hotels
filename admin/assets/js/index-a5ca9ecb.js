import{u as P,d as L}from"./useHandleData-899ca090.js";import{P as V,m as M,a as j}from"./order-3c724f3a.js";import{_ as v}from"./index.vue_vue_type_script_setup_true_name_dialogRes_lang-44d68dcf.js";import{_}from"./index.vue_vue_type_script_setup_true_lang-ba6abaa3.js";import{d as h,h as p,i as s,k as z,r as w,o as B,j as H,f as o,w as a,b as u,t as U,u as x,E as W}from"./main-59e74578.js";import{p as G}from"./serviceDict-2813f393.js";import"./_plugin-vue_export-helper-c27b6911.js";const K={class:"table-box"},Q=h({name:"user-list"}),re=h({...Q,setup(X){const m=p(),k=s({type:1}),C=l=>({list:l.records,total:l.total,pageNum:l.pageNum,pageSize:l.pageSize}),T=l=>{let e=JSON.parse(JSON.stringify(l));return e.username&&(e.username="custom-"+e.username),M()},R=[{prop:"username",label:"用户名",width:"90px",search:{order:1,el:"input"}},{prop:"password",label:"用户密码",width:"120px"},{prop:"email",label:"电子邮箱",width:"150px"},{prop:"phone",label:"联系电话",labelWidth:90,width:"150px",search:{el:"input"}},{prop:"balance",label:"账户余额",width:"100px"},{prop:"points",label:"积分"},{prop:"level",label:"会员等级",width:"100px"},{prop:"create_time",label:"注册日期",width:"150px"},{prop:"login_time",label:"最后登录日期"},{prop:"operation",label:"操作",fixed:"right",width:190}],D=async l=>{await P(L,{id:l},"确认要冻结该用户吗?"),m.value.clearSelection(),m.value.getTableList()},n=s({tradeDay:z(),orderId:"",org:"",type:"",price:"",total:0,volume:"",action:0,tradeType:""});let N=s([{xType:"Input",label:"用户名",prop:"orderId",placeholder:"请填写用户名",clearable:!0,span:24},{xType:"Input",label:"电子邮箱",prop:"dealerAid",placeholder:"请填写电子邮箱",clearable:!0,span:24},{xType:"Input",label:"用户手机号",prop:"price",placeholder:"请填写",span:24},{xType:"Input",label:"账户余额",prop:"price",placeholder:"请填写",span:24},{xType:"Input",label:"积分",prop:"volume",placeholder:"请填写上山数量",span:24,rows:5},{xType:"Input",label:"会员等级",prop:"price",placeholder:"请填写",span:24},{slotName:"Actions"}]);function E(l,e){}function I(l){f.value=!0}const g=s({symbol:[{required:!0,message:"请输入名字",trigger:"blur"}],orderId:[{required:!0,message:"请填写"}],type:[{required:!0,message:"请填写"}],price:[{required:!0,message:"请填写"}],volume:[{required:!0,message:"请选择"}],tradeDay:[{required:!0,message:"请填写"}]}),i=p(null),S=async()=>{var e;if(!i.value)return;await((e=i.value)==null?void 0:e.formRef).validate(async(r,d)=>{if(!r)return;let t=JSON.parse(JSON.stringify(n));(await j(t)).code==0&&(W.success("添加成功！"),m.value.getTableList(),c.value=!1)})},$=p(null),F=async()=>{var e;if(!i.value)return;await((e=i.value)==null?void 0:e.formRef).validate(async(r,d)=>{if(!r)return;let t=JSON.parse(JSON.stringify(n))})},q=s({permissionsMenu:[]});let O=s([{xType:"Tree",label:"",prop:"permissionsMenu",data:G,style:"display:block;float:left","show-checkbox":!0,"node-key":"id",check:E,float:"left",span:24}]);const c=p(!1),f=p(!1),A=()=>{c.value=!1},y=l=>{l!=1&&Object.assign(n,l),c.value=!0},J=()=>{f.value=!1};return(l,e)=>{const r=w("el-button"),d=w("el-tag");return B(),H("div",K,[o(V,{ref_key:"proTable",ref:m,title:"用户列表",columns:R,requestApi:T,initParam:k,dataCallback:C},{tableHeader:a(()=>[o(r,{icon:"plus",type:"primary",onClick:e[0]||(e[0]=t=>y(1))},{default:a(()=>[u("新增用户")]),_:1})]),num:a(t=>[o(d,{type:"success"},{default:a(()=>[u(U(t.row.num==10?"正常":"-"),1)]),_:2},1024)]),operation:a(t=>[o(r,{link:"",onClick:e[1]||(e[1]=b=>y(1)),type:"primary"},{default:a(()=>[u("修改")]),_:1}),o(r,{link:"",onClick:b=>I(t.row),type:"primary"},{default:a(()=>[u("密码重置")]),_:2},1032,["onClick"]),o(r,{link:"",onClick:b=>D(t.row.selectedListIds),type:"danger"},{default:a(()=>[u("冻结")]),_:2},1032,["onClick"])]),_:1},8,["initParam"]),o(v,{visible:c.value,confirmName:"确认",title:"新增",onClose:e[2]||(e[2]=t=>A()),onConfirm:e[3]||(e[3]=t=>S()),width:"408px"},{default:a(()=>[o(_,{formData:n,formColumns:x(N),formRules:g,"label-width":"120px",ref_key:"baseForm",ref:i},null,8,["formData","formColumns","formRules"])]),_:1},8,["visible"]),o(v,{visible:f.value,confirmName:"保存",title:"权限管理",onClose:e[4]||(e[4]=t=>J()),onConfirm:e[5]||(e[5]=t=>F()),width:"408px"},{default:a(()=>[o(_,{formData:q,formColumns:x(O),formRules:g,"label-width":"0px",ref_key:"baseForm2",ref:$},null,8,["formData","formColumns","formRules"])]),_:1},8,["visible"])])}}});export{re as default};
