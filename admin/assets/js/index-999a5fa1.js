import{u as O,d as A}from"./useHandleData-899ca090.js";import{n as B,d as k,h as p,i as c,k as F,r as J,o as y,j as q,f as _,w as m,c as w,b as v,e as C}from"./main-59e74578.js";import{P as L,b as V}from"./order-3c724f3a.js";import{_ as H}from"./index.vue_vue_type_script_setup_true_name_dialogRes_lang-44d68dcf.js";import{_ as I}from"./index.vue_vue_type_script_setup_true_lang-ba6abaa3.js";import"./_plugin-vue_export-helper-c27b6911.js";const j=(h,l)=>new Promise((u,d)=>{B.confirm(h,l,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0,center:!0}).then(()=>{u(!0)}).catch(()=>{d(!0)})}),z={class:"table-box"},M=k({name:"off-line-order"}),Z=k({...M,setup(h){const l=p(),u=c({type:1}),d=e=>({list:e.records,total:e.total,pageNum:e.pageNum,pageSize:e.pageSize}),T=e=>{let t=JSON.parse(JSON.stringify(e));return t.username&&(t.username="custom-"+t.username),V()},N=[{prop:"orderId",label:"订单号",width:"200px",search:{el:"input",order:1}},{prop:"username",label:"会员",width:"100px"},{prop:"phone",label:"会员手机号",width:"150px",search:{el:"input"}},{prop:"balance",label:"房间号",width:"100px"},{prop:"status",label:"订单状态",width:"150px"},{prop:"create_time",label:"预定日期",width:"170px"},{prop:"create_time2",label:"入住日期",width:"170px"},{prop:"login_time",label:"退房日期",width:"170px"},{prop:"price",label:"房间价格",width:"170px"},{prop:"operation",label:"操作",fixed:"right",width:150}],S=async e=>{await O(A,{id:e},"确认要取消当前订单吗"),l.value.clearSelection(),l.value.getTableList()},o=c({tradeDay:F(),orderId:"SFE332334343334343",org:"上海古河健身中心",type:"录入",price:"",total:0,volume:0,action:0,orderType:5,symbol:"",aid:"",dealerAid:"",clearAid:"",aid2:"",dealerAid2:"",clearAid2:"",tradeType:"",product:"SF038293343"}),x=c([{xType:"Input",label:"房间号",prop:"balance",placeholder:"请填写房间号",disabled:!1,span:24},{xType:"DatePicker",label:"入住日期",prop:"create_time2",placeholder:"请选择日期",disabled:!1,span:24},{xType:"DatePicker",label:"退房日期",prop:"login_time",placeholder:"请选择日期",disabled:!1,span:24},{slotName:"Actions"}]),D=c({symbol:[{required:!0,message:"请输入名字",trigger:"blur"}],price:[{required:!0,message:"请填写"}],volume:[{required:!0,message:"请选择"}],tradeDay:[{required:!0,message:"请填写"}]}),f=p(null),P=async()=>{var t;if(!f.value)return;await((t=f.value)==null?void 0:t.formRef).validate(async(s,a)=>{if(!s)return;let g=JSON.parse(JSON.stringify(o)),i=JSON.parse(JSON.stringify(x)),n="<ul style='list-style:none;'>";for(let r=0;r<i.length;r++)i[r].xType&&(n+=`<li style='display:flex'><span style='width:150px;text-align:end'>${i[r].label}</span>: <span style='padding-left:10px'>${g[i[r].prop]}</span></li>`);n+="</ul>",j(n,"请确认交易").then(()=>{}).catch(()=>{})})},b=p(!1),R=p(!1),$=()=>{b.value=!1,R.value=!1},E=e=>{e!=1&&Object.assign(o,e),b.value=!0};return(e,t)=>{const s=J("el-button");return y(),q("div",z,[_(L,{ref_key:"proTable",ref:l,title:"用户列表",columns:N,requestApi:T,initParam:u,dataCallback:d},{operation:m(a=>[a.row.status=="已预订"?(y(),w(s,{key:0,link:"",onClick:g=>E(a.row),type:"primary"},{default:m(()=>[v("修改")]),_:2},1032,["onClick"])):C("",!0),a.row.status=="已预订"?(y(),w(s,{key:1,link:"",onClick:g=>S(a.row.selectedListIds),type:"danger"},{default:m(()=>[v("取消订单")]),_:2},1032,["onClick"])):C("",!0)]),_:1},8,["initParam"]),_(H,{visible:b.value,confirmName:"确认",title:"修改",onClose:t[0]||(t[0]=a=>$()),onConfirm:t[1]||(t[1]=a=>P()),width:"30%"},{default:m(()=>[_(I,{formData:o,formColumns:x,formRules:D,"label-width":"136px",ref_key:"baseForm",ref:f},null,8,["formData","formColumns","formRules"])]),_:1},8,["visible"])])}}});export{Z as default};
